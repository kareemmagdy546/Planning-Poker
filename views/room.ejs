<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planning Poker - Room</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
<div class="room-container">
    <header class="room-header">
        <div class="room-info">
            <h1>Planning Poker</h1>
            <div class="room-info-text">
                <span>Planning Poker Room</span>
            </div>
        </div>
        <button id="leave-room" class="btn btn-danger">Leave Room</button>
    </header>

    <div class="room-content">
        <div class="main-area">
            <div class="story-section">
                <h2>Current Story</h2>
                <div id="current-story" class="story-card">
                    <p class="no-story">No story selected. Add a story to begin estimating.</p>
                </div>
            </div>

            <div class="voting-section">
                <h2>Your Vote</h2>
                <div id="voting-status" class="voting-status">
                    <span id="vote-status-text">Waiting for story...</span>
                    <div id="vote-timer" class="vote-timer" style="display: none;">
                        <span id="timer-text">Time remaining: <strong id="timer-countdown">10</strong>s</span>
                    </div>
                </div>
                <div id="vote-cards" class="vote-cards">
                    <!-- Voting cards will be inserted here -->
                </div>
                <div id="voting-actions" class="voting-actions" style="display: none;">
                    <button id="restart-voting-btn" class="btn btn-secondary">Restart Voting</button>
                </div>
                <div id="vote-result" class="vote-result" style="display: none;">
                    <!-- Vote results will be shown here -->
                </div>
            </div>
        </div>

        <div class="sidebar">
            <div class="users-section">
                <h3>Participants (<span id="user-count">0</span>)</h3>
                <div id="users-list" class="users-list">
                    <!-- Users will be listed here -->
                </div>
            </div>

            <div class="stories-section">
                <h3>Stories</h3>
                <button id="add-story-btn" class="btn btn-small">+ Add Story</button>
                <div id="stories-list" class="stories-list">
                    <!-- Stories will be listed here -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Story Modal -->
<div id="add-story-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Add Story</h2>
            <button class="modal-close" id="close-add-story">&times;</button>
        </div>
        <form id="add-story-form">
            <div class="form-group">
                <label for="story-title">Title</label>
                <input type="text" id="story-title" name="title" placeholder="Story title" required>
            </div>
            <div class="form-group">
                <label for="story-description">Description (optional)</label>
                <textarea id="story-description" name="description" placeholder="Story description" rows="4"></textarea>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" id="cancel-add-story">Cancel</button>
                <button type="submit" class="btn btn-primary">Add Story</button>
            </div>
        </form>
    </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
    // Pass allowed email domain to client
    const ALLOWED_EMAIL_DOMAIN = '<%= typeof allowedEmailDomain !== 'undefined' ? allowedEmailDomain : '' %>';
</script>
<script src="/js/client.js"></script>
</body>
</html>
